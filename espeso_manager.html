<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Espanso Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Custom Glassmorphic Styles */
        .glass {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(75, 85, 99, 0.3);
        }
        
        .glass-panel {
            background: rgba(31, 41, 55, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(107, 114, 128, 0.2);
        }
        
        .neon-border {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
            border: 1px solid rgba(59, 130, 246, 0.5);
        }
        
        .neon-glow:hover {
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.6);
            transition: all 0.3s ease;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, rgba(17, 24, 39, 0.9) 0%, rgba(31, 41, 55, 0.9) 100%);
        }
        
        /* Animated background */
        .animated-bg {
            background: linear-gradient(-45deg, #0f172a, #1e293b, #334155, #475569);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(17, 24, 39, 0.3);
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(59, 130, 246, 0.5);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(59, 130, 246, 0.7);
        }
        
        /* Form controls styling */
        .form-input {
            background: rgba(17, 24, 39, 0.6);
            border: 1px solid rgba(75, 85, 99, 0.4);
            color: #f9fafb;
        }
        
        .form-input:focus {
            border-color: rgba(59, 130, 246, 0.8);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        /* Syntax highlighting for YAML */
        .yaml-editor {
            font-family: 'Courier New', monospace;
            background: rgba(17, 24, 39, 0.8);
            color: #e5e7eb;
        }
        
        .yaml-key { color: #60a5fa; }
        .yaml-value { color: #34d399; }
        .yaml-comment { color: #6b7280; }
    </style>
</head>
<body class="animated-bg min-h-screen text-gray-100" x-data="espansoManager()">
    
    <!-- Main Container -->
    <div class="flex h-screen overflow-hidden">
        
        <!-- Sidebar Navigation -->
        <div class="w-64 glass flex-shrink-0 border-r border-gray-600">
            <div class="p-6">
                <div class="flex items-center space-x-3 mb-8">
                    <i class="fas fa-expand-arrows-alt text-blue-400 text-2xl"></i>
                    <h1 class="text-xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
                        Espanso Manager
                    </h1>
                </div>
                
                <!-- Search Bar -->
                <div class="relative mb-6">
                    <input 
                        type="text" 
                        placeholder="Search expansions (Alt+Space)"
                        class="w-full px-4 py-2 form-input rounded-lg pl-10"
                        x-model="searchQuery"
                        @keyup.alt.space.window="$el.focus()"
                    >
                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                </div>
                
                <!-- Navigation Menu -->
                <nav class="space-y-2">
                    <template x-for="item in navItems" :key="item.id">
                        <button 
                            @click="activeTab = item.id"
                            :class="{'neon-border bg-blue-500/20': activeTab === item.id}"
                            class="w-full text-left px-4 py-3 rounded-lg hover:bg-gray-700/50 transition-all duration-200 flex items-center space-x-3"
                        >
                            <i :class="item.icon" class="text-blue-400"></i>
                            <span x-text="item.name"></span>
                        </button>
                    </template>
                </nav>
            </div>
        </div>
        
        <!-- Main Content Area -->
        <div class="flex-1 flex flex-col overflow-hidden">
            
            <!-- Header -->
            <header class="glass-panel p-4 border-b border-gray-600">
                <div class="flex items-center justify-between">
                    <h2 x-text="navItems.find(item => item.id === activeTab)?.name || 'Dashboard'" 
                        class="text-2xl font-semibold text-white"></h2>
                    <div class="flex items-center space-x-4">
                        <!-- Theme Toggle -->
                        <button @click="toggleTheme()" class="p-2 rounded-lg hover:bg-gray-700/50 transition-colors">
                            <i class="fas fa-palette text-yellow-400"></i>
                        </button>
                        <!-- Settings -->
                        <button class="p-2 rounded-lg hover:bg-gray-700/50 transition-colors">
                            <i class="fas fa-cog text-gray-400"></i>
                        </button>
                    </div>
                </div>
            </header>
            
            <!-- Content Panels -->
            <main class="flex-1 overflow-auto p-6">
                
                <!-- Expansion Composer -->
                <div x-show="activeTab === 'composer'" class="space-y-6">
                    <div class="glass-panel rounded-xl p-6">
                        <h3 class="text-xl font-semibold mb-6 flex items-center">
                            <i class="fas fa-edit mr-3 text-green-400"></i>
                            Expansion Composer
                        </h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Form Editor -->
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Trigger</label>
                                    <input 
                                        type="text" 
                                        placeholder=":email"
                                        class="w-full px-4 py-2 form-input rounded-lg"
                                        x-model="currentExpansion.trigger"
                                    >
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium mb-2">Replacement</label>
                                    <textarea 
                                        placeholder="john.doe@example.com"
                                        class="w-full px-4 py-3 form-input rounded-lg h-32 resize-none"
                                        x-model="currentExpansion.replacement"
                                    ></textarea>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Type</label>
                                        <select class="w-full px-4 py-2 form-input rounded-lg" x-model="currentExpansion.type">
                                            <option value="text">Text</option>
                                            <option value="script">Script</option>
                                            <option value="form">Form</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Category</label>
                                        <input 
                                            type="text" 
                                            placeholder="email"
                                            class="w-full px-4 py-2 form-input rounded-lg"
                                            x-model="currentExpansion.category"
                                        >
                                    </div>
                                </div>
                                
                                <div class="flex space-x-3">
                                    <button @click="saveExpansion()" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg neon-glow transition-all">
                                        <i class="fas fa-save mr-2"></i>Save
                                    </button>
                                    <button @click="previewExpansion()" class="px-6 py-2 bg-green-600 hover:bg-green-700 rounded-lg neon-glow transition-all">
                                        <i class="fas fa-eye mr-2"></i>Preview
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Live Preview -->
                            <div class="glass rounded-lg p-4">
                                <h4 class="text-lg font-medium mb-4 text-blue-400">Live Preview</h4>
                                <div class="bg-gray-900/50 rounded-lg p-4 min-h-32">
                                    <div class="text-sm text-gray-400 mb-2">Input: <span class="text-yellow-400" x-text="currentExpansion.trigger || ':trigger'"></span></div>
                                    <div class="text-sm text-gray-400 mb-2">Output:</div>
                                    <div class="text-green-400 font-mono" x-text="previewText"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Variable Manager -->
                <div x-show="activeTab === 'variables'" class="space-y-6">
                    <div class="glass-panel rounded-xl p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-semibold flex items-center">
                                <i class="fas fa-code mr-3 text-purple-400"></i>
                                Variable Manager
                            </h3>
                            <button @click="addVariable()" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg neon-glow transition-all">
                                <i class="fas fa-plus mr-2"></i>Add Variable
                            </button>
                        </div>
                        
                        <div class="grid gap-4">
                            <template x-for="variable in variables" :key="variable.id">
                                <div class="glass rounded-lg p-4 flex items-center justify-between">
                                    <div class="flex-1 grid grid-cols-3 gap-4">
                                        <input 
                                            type="text" 
                                            placeholder="Variable name"
                                            class="px-3 py-2 form-input rounded"
                                            x-model="variable.name"
                                        >
                                        <select class="px-3 py-2 form-input rounded" x-model="variable.type">
                                            <option value="text">Text</option>
                                            <option value="choice">Choice</option>
                                            <option value="date">Date</option>
                                            <option value="shell">Shell</option>
                                        </select>
                                        <input 
                                            type="text" 
                                            placeholder="Default value"
                                            class="px-3 py-2 form-input rounded"
                                            x-model="variable.default"
                                        >
                                    </div>
                                    <button @click="removeVariable(variable.id)" class="ml-4 p-2 text-red-400 hover:bg-red-500/20 rounded">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
                
                <!-- Forms Engine -->
                <div x-show="activeTab === 'forms'" class="space-y-6">
                    <div class="glass-panel rounded-xl p-6">
                        <h3 class="text-xl font-semibold mb-6 flex items-center">
                            <i class="fas fa-wpforms mr-3 text-orange-400"></i>
                            Forms Engine
                        </h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Form Builder -->
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <h4 class="text-lg font-medium">Form Fields</h4>
                                    <button @click="addFormField()" class="px-3 py-1 bg-orange-600 hover:bg-orange-700 rounded text-sm neon-glow transition-all">
                                        <i class="fas fa-plus mr-1"></i>Add Field
                                    </button>
                                </div>
                                
                                <div class="space-y-3">
                                    <template x-for="field in formFields" :key="field.id">
                                        <div class="glass rounded-lg p-3">
                                            <div class="grid grid-cols-3 gap-2 mb-2">
                                                <input 
                                                    type="text" 
                                                    placeholder="Field name"
                                                    class="px-2 py-1 form-input rounded text-sm"
                                                    x-model="field.name"
                                                >
                                                <select class="px-2 py-1 form-input rounded text-sm" x-model="field.type">
                                                    <option value="text">Text</option>
                                                    <option value="textarea">Textarea</option>
                                                    <option value="choice">Choice</option>
                                                    <option value="multiline">Multiline</option>
                                                </select>
                                                <button @click="removeFormField(field.id)" class="text-red-400 hover:bg-red-500/20 rounded">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </div>
                                            <input 
                                                type="text" 
                                                placeholder="Default value"
                                                class="w-full px-2 py-1 form-input rounded text-sm"
                                                x-model="field.default"
                                            >
                                        </div>
                                    </template>
                                </div>
                            </div>
                            
                            <!-- Form Preview -->
                            <div class="glass rounded-lg p-4">
                                <h4 class="text-lg font-medium mb-4 text-orange-400">Form Preview</h4>
                                <div class="space-y-3">
                                    <template x-for="field in formFields" :key="field.id">
                                        <div>
                                            <label class="block text-sm font-medium mb-1" x-text="field.name || 'Field Name'"></label>
                                            <input 
                                                :type="field.type === 'textarea' ? 'text' : 'text'"
                                                class="w-full px-3 py-2 form-input rounded text-sm"
                                                :placeholder="field.default || 'Enter value...'"
                                            >
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Package Manager -->
                <div x-show="activeTab === 'packages'" class="space-y-6">
                    <div class="glass-panel rounded-xl p-6">
                        <h3 class="text-xl font-semibold mb-6 flex items-center">
                            <i class="fas fa-box mr-3 text-indigo-400"></i>
                            Package Manager
                        </h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <template x-for="package in packages" :key="package.id">
                                <div class="glass rounded-lg p-4 hover:neon-border transition-all">
                                    <div class="flex items-center justify-between mb-3">
                                        <h4 class="font-semibold" x-text="package.name"></h4>
                                        <span :class="package.installed ? 'text-green-400' : 'text-gray-400'" class="text-sm">
                                            <i :class="package.installed ? 'fas fa-check-circle' : 'far fa-circle'"></i>
                                        </span>
                                    </div>
                                    <p class="text-sm text-gray-400 mb-4" x-text="package.description"></p>
                                    <div class="flex items-center justify-between">
                                        <span class="text-xs text-blue-400" x-text="package.author"></span>
                                        <button 
                                            @click="togglePackage(package.id)"
                                            :class="package.installed ? 'bg-red-600 hover:bg-red-700' : 'bg-green-600 hover:bg-green-700'"
                                            class="px-3 py-1 rounded text-xs neon-glow transition-all"
                                            x-text="package.installed ? 'Uninstall' : 'Install'"
                                        ></button>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
                
                <!-- Configuration Panel -->
                <div x-show="activeTab === 'config'" class="space-y-6">
                    <div class="glass-panel rounded-xl p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-semibold flex items-center">
                                <i class="fas fa-cogs mr-3 text-red-400"></i>
                                Configuration
                            </h3>
                            <div class="flex space-x-2">
                                <button @click="yamlMode = !yamlMode" 
                                        class="px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg transition-all">
                                    <i class="fas fa-code mr-2"></i>
                                    <span x-text="yamlMode ? 'GUI Mode' : 'YAML Mode'"></span>
                                </button>
                                <button @click="saveConfig()" class="px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg neon-glow transition-all">
                                    <i class="fas fa-save mr-2"></i>Save Config
                                </button>
                            </div>
                        </div>
                        
                        <!-- YAML Editor -->
                        <div x-show="yamlMode" class="glass rounded-lg p-4">
                            <textarea 
                                class="w-full h-96 yaml-editor rounded p-4 font-mono text-sm resize-none"
                                x-model="configYaml"
                                placeholder="# Espanso Configuration
# Edit your configuration here...

matches:
  - trigger: ':email'
    replace: 'john.doe@example.com'
  
  - trigger: ':date'
    replace: '{{date}}'
    vars:
      - name: date
        type: date
        params:
          format: '%Y-%m-%d'"
                            ></textarea>
                        </div>
                        
                        <!-- GUI Editor -->
                        <div x-show="!yamlMode" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="glass rounded-lg p-4">
                                    <h4 class="text-lg font-medium mb-4">General Settings</h4>
                                    <div class="space-y-3">
                                        <div class="flex items-center justify-between">
                                            <label class="text-sm">Auto-restart</label>
                                            <input type="checkbox" class="form-checkbox" x-model="config.auto_restart">
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <label class="text-sm">Show notifications</label>
                                            <input type="checkbox" class="form-checkbox" x-model="config.show_notifications">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium mb-1">Toggle key</label>
                                            <input type="text" class="w-full px-3 py-2 form-input rounded" x-model="config.toggle_key">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="glass rounded-lg p-4">
                                    <h4 class="text-lg font-medium mb-4">Advanced Settings</h4>
                                    <div class="space-y-3">
                                        <div>
                                            <label class="block text-sm font-medium mb-1">Backend</label>
                                            <select class="w-full px-3 py-2 form-input rounded" x-model="config.backend">
                                                <option value="Auto">Auto</option>
                                                <option value="Clipboard">Clipboard</option>
                                                <option value="Inject">Inject</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium mb-1">Clipboard threshold</label>
                                            <input type="number" class="w-full px-3 py-2 form-input rounded" x-model="config.clipboard_threshold">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Import/Export -->
                <div x-show="activeTab === 'import-export'" class="space-y-6">
                    <div class="glass-panel rounded-xl p-6">
                        <h3 class="text-xl font-semibold mb-6 flex items-center">
                            <i class="fas fa-exchange-alt mr-3 text-cyan-400"></i>
                            Import / Export
                        </h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Import Section -->
                            <div class="glass rounded-lg p-6">
                                <h4 class="text-lg font-medium mb-4 text-green-400">Import</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Import Type</label>
                                        <select class="w-full px-3 py-2 form-input rounded" x-model="importType">
                                            <option value="expansions">Expansions</option>
                                            <option value="config">Configuration</option>
                                            <option value="variables">Variables</option>
                                            <option value="all">Complete Backup</option>
                                        </select>
                                    </div>
                                    <div class="border-2 border-dashed border-gray-600 rounded-lg p-8 text-center hover:border-blue-400 transition-colors">
                                        <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                                        <p class="text-gray-400">Drop files here or click to browse</p>
                                        <input type="file" class="hidden" accept=".yaml,.yml,.json">
                                    </div>
                                    <button class="w-full px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg neon-glow transition-all">
                                        <i class="fas fa-upload mr-2"></i>Import
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Export Section -->
                            <div class="glass rounded-lg p-6">
                                <h4 class="text-lg font-medium mb-4 text-blue-400">Export</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Export Type</label>
                                        <select class="w-full px-3 py-2 form-input rounded" x-model="exportType">
                                            <option value="expansions">Expansions Only</option>
                                            <option value="config">Configuration Only</option>
                                            <option value="variables">Variables Only</option>
                                            <option value="all">Complete Backup</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Format</label>
                                        <select class="w-full px-3 py-2 form-input rounded" x-model="exportFormat">
                                            <option value="yaml">YAML</option>
                                            <option value="json">JSON</option>
                                        </select>
                                    </div>
                                    <button @click="exportData()" class="w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg neon-glow transition-all">
                                        <i class="fas fa-download mr-2"></i>Export
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Recent Backups -->
                        <div class="mt-8">
                            <h4 class="text-lg font-medium mb-4">Recent Backups</h4>
                            <div class="glass rounded-lg p-4">
                                <div class="space-y-2">
                                    <template x-for="backup in recentBackups" :key="backup.id">
                                        <div class="flex items-center justify-between p-3 hover:bg-gray-700/30 rounded">
                                            <div>
                                                <span class="font-medium" x-text="backup.name"></span>
                                                <span class="text-sm text-gray-400 ml-2" x-text="backup.date"></span>
                                            </div>
                                            <div class="flex space-x-2">
                                                <button class="px-3 py-1 bg-green-600 hover:bg-green-700 rounded text-sm">
                                                    <i class="fas fa-download mr-1"></i>Restore
                                                </button>
                                                <button class="px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm">
                                                    <i class="fas fa-trash mr-1"></i>Delete
                                                </button>
                                            </div>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            </main>
        </div>
    </div>
    
    <!-- Status Bar -->
    <div class="fixed bottom-4 right-4 glass-panel rounded-lg px-4 py-2 flex items-center space-x-3">
        <div class="flex items-center space-x-2">
            <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
            <span class="text-sm">Espanso Connected</span>
        </div>
        <div class="text-gray-400 text-sm" x-text="'Expansions: ' + expansions.length"></div>
    </div>

    <script>
        function espansoManager() {
            return {
                // Navigation
                activeTab: 'composer',
                searchQuery: '',
                yamlMode: false,
                
                // Navigation items
                navItems: [
                    { id: 'composer', name: 'Expansion Composer', icon: 'fas fa-edit' },
                    { id: 'variables', name: 'Variable Manager', icon: 'fas fa-code' },
                    { id: 'forms', name: 'Forms Engine', icon: 'fas fa-wpforms' },
                    { id: 'packages', name: 'Package Manager', icon: 'fas fa-box' },
                    { id: 'config', name: 'Configuration', icon: 'fas fa-cogs' },
                    { id: 'import-export', name: 'Import/Export', icon: 'fas fa-exchange-alt' }
                ],
                
                // Current expansion being edited
                currentExpansion: {
                    trigger: '',
                    replacement: '',
                    type: 'text',
                    category: ''
                },
                
                // Variables
                variables: [
                    { id: 1, name: 'date', type: 'date', default: '%Y-%m-%d' },
                    { id: 2, name: 'time', type: 'shell', default: 'date +%H:%M' },
                    { id: 3, name: 'username', type: 'text', default: 'user' }
                ],
                
                // Form fields
                formFields: [
                    { id: 1, name: 'name', type: 'text', default: 'Enter your name' },
                    { id: 2, name: 'email', type: 'text', default: 'user@example.com' }
                ],
                
                // Packages
                packages: [
                    { id: 1, name: 'all-emojis', description: 'Complete emoji collection for quick access', author: 'espanso-hub', installed: true },
                    { id: 2, name: 'html-utils', description: 'HTML tags and entities shortcuts', author: 'web-dev', installed: false },
                    { id: 3, name: 'git-shortcuts', description: 'Common git commands and workflows', author: 'dev-tools', installed: true },
                    { id: 4, name: 'math-symbols', description: 'Mathematical symbols and equations', author: 'science', installed: false },
                    { id: 5, name: 'lorem-ipsum', description: 'Lorem ipsum text generators', author: 'content', installed: false },
                    { id: 6, name: 'currency-codes', description: 'ISO currency codes and symbols', author: 'finance', installed: true }
                ],
                
                // Configuration
                config: {
                    auto_restart: true,
                    show_notifications: true,
                    toggle_key: 'ALT+SPACE',
                    backend: 'Auto',
                    clipboard_threshold: 100
                },
                
                configYaml: `# Espanso Configuration
# Main configuration file

matches:
  - trigger: ":email"
    replace: "john.doe@example.com"
  
  - trigger: ":sig"
    replace: |
      Best regards,
      John Doe
      Software Developer
      
  - trigger: ":date"
    replace: "{{mydate}}"
    vars:
      - name: mydate
        type: date
        params:
          format: "%Y-%m-%d"
          
  - trigger: ":time"
    replace: "{{mytime}}"
    vars:
      - name: mytime
        type: shell
        params:
          cmd: "date +%H:%M:%S"

# Global settings
auto_restart: true
show_notifications: true
toggle_key: "ALT+SPACE"
backend: Auto
clipboard_threshold: 100`,
                
                // Import/Export
                importType: 'expansions',
                exportType: 'expansions',
                exportFormat: 'yaml',
                
                recentBackups: [
                    { id: 1, name: 'Full Backup', date: '2024-08-01 14:30' },
                    { id: 2, name: 'Expansions Only', date: '2024-07-28 09:15' },
                    { id: 3, name: 'Config Backup', date: '2024-07-25 16:45' }
                ],
                
                // Expansions list
                expansions: [
                    { id: 1, trigger: ':email', replacement: 'john.doe@example.com', type: 'text' },
                    { id: 2, trigger: ':sig', replacement: 'Best regards,\nJohn Doe', type: 'text' },
                    { id: 3, trigger: ':date', replacement: '{{date}}', type: 'text' }
                ],
                
                // Computed properties
                get previewText() {
                    let text = this.currentExpansion.replacement || 'No replacement text';
                    // Simple variable substitution for preview
                    text = text.replace(/\{\{date\}\}/g, new Date().toISOString().split('T')[0]);
                    text = text.replace(/\{\{time\}\}/g, new Date().toLocaleTimeString());
                    return text;
                },
                
                // Methods
                init() {
                    // Initialize the application
                    this.loadData();
                    
                    // Add keyboard shortcut listeners
                    document.addEventListener('keydown', (e) => {
                        if (e.altKey && e.code === 'Space') {
                            e.preventDefault();
                            // Focus search bar
                            document.querySelector('input[placeholder*="Search"]').focus();
                        }
                    });
                },
                
                loadData() {
                    // Load data from localStorage or initialize with defaults
                    const savedExpansions = localStorage.getItem('espanso_expansions');
                    if (savedExpansions) {
                        this.expansions = JSON.parse(savedExpansions);
                    }
                    
                    const savedConfig = localStorage.getItem('espanso_config');
                    if (savedConfig) {
                        this.config = JSON.parse(savedConfig);
                    }
                },
                
                saveExpansion() {
                    if (!this.currentExpansion.trigger || !this.currentExpansion.replacement) {
                        alert('Please fill in both trigger and replacement fields');
                        return;
                    }
                    
                    const newExpansion = {
                        id: Date.now(),
                        ...this.currentExpansion
                    };
                    
                    this.expansions.push(newExpansion);
                    this.saveData();
                    
                    // Reset form
                    this.currentExpansion = {
                        trigger: '',
                        replacement: '',
                        type: 'text',
                        category: ''
                    };
                    
                    this.showNotification('Expansion saved successfully!', 'success');
                },
                
                previewExpansion() {
                    if (!this.currentExpansion.replacement) {
                        alert('No replacement text to preview');
                        return;
                    }
                    
                    // This would trigger the live preview update
                    this.showNotification('Preview updated', 'info');
                },
                
                addVariable() {
                    const newVariable = {
                        id: Date.now(),
                        name: '',
                        type: 'text',
                        default: ''
                    };
                    this.variables.push(newVariable);
                },
                
                removeVariable(id) {
                    this.variables = this.variables.filter(v => v.id !== id);
                    this.saveData();
                },
                
                addFormField() {
                    const newField = {
                        id: Date.now(),
                        name: '',
                        type: 'text',
                        default: ''
                    };
                    this.formFields.push(newField);
                },
                
                removeFormField(id) {
                    this.formFields = this.formFields.filter(f => f.id !== id);
                },
                
                togglePackage(id) {
                    const package = this.packages.find(p => p.id === id);
                    if (package) {
                        package.installed = !package.installed;
                        this.showNotification(
                            `Package ${package.name} ${package.installed ? 'installed' : 'uninstalled'}`,
                            package.installed ? 'success' : 'warning'
                        );
                    }
                },
                
                saveConfig() {
                    localStorage.setItem('espanso_config', JSON.stringify(this.config));
                    this.showNotification('Configuration saved successfully!', 'success');
                },
                
                exportData() {
                    let data = {};
                    
                    switch (this.exportType) {
                        case 'expansions':
                            data = { expansions: this.expansions };
                            break;
                        case 'config':
                            data = { config: this.config };
                            break;
                        case 'variables':
                            data = { variables: this.variables };
                            break;
                        case 'all':
                            data = {
                                expansions: this.expansions,
                                config: this.config,
                                variables: this.variables,
                                formFields: this.formFields
                            };
                            break;
                    }
                    
                    const filename = `espanso-backup-${this.exportType}-${new Date().toISOString().split('T')[0]}.${this.exportFormat}`;
                    const content = this.exportFormat === 'yaml' ? this.toYAML(data) : JSON.stringify(data, null, 2);
                    
                    this.downloadFile(filename, content);
                    this.showNotification('Data exported successfully!', 'success');
                },
                
                toYAML(obj) {
                    // Simple YAML conversion (for demonstration)
                    let yaml = '';
                    for (const [key, value] of Object.entries(obj)) {
                        yaml += `${key}:\n`;
                        if (Array.isArray(value)) {
                            value.forEach(item => {
                                yaml += `  - `;
                                if (typeof item === 'object') {
                                    for (const [k, v] of Object.entries(item)) {
                                        yaml += `${k}: ${JSON.stringify(v)}\n    `;
                                    }
                                } else {
                                    yaml += `${JSON.stringify(item)}\n`;
                                }
                            });
                        } else if (typeof value === 'object') {
                            for (const [k, v] of Object.entries(value)) {
                                yaml += `  ${k}: ${JSON.stringify(v)}\n`;
                            }
                        }
                        yaml += '\n';
                    }
                    return yaml;
                },
                
                downloadFile(filename, content) {
                    const blob = new Blob([content], { type: 'text/plain' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                },
                
                saveData() {
                    localStorage.setItem('espanso_expansions', JSON.stringify(this.expansions));
                    localStorage.setItem('espanso_variables', JSON.stringify(this.variables));
                    localStorage.setItem('espanso_config', JSON.stringify(this.config));
                },
                
                toggleTheme() {
                    // Theme toggle functionality
                    document.body.classList.toggle('light-theme');
                    this.showNotification('Theme toggled', 'info');
                },
                
                showNotification(message, type = 'info') {
                    // Create notification element
                    const notification = document.createElement('div');
                    notification.className = `fixed top-4 right-4 p-4 rounded-lg glass-panel z-50 transform transition-all duration-300 translate-x-full`;
                    
                    const colors = {
                        success: 'border-green-500 text-green-400',
                        warning: 'border-yellow-500 text-yellow-400',
                        error: 'border-red-500 text-red-400',
                        info: 'border-blue-500 text-blue-400'
                    };
                    
                    notification.className += ` ${colors[type] || colors.info}`;
                    notification.innerHTML = `
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-${type === 'success' ? 'check' : type === 'warning' ? 'exclamation-triangle' : type === 'error' ? 'times' : 'info-circle'}"></i>
                            <span>${message}</span>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    // Animate in
                    setTimeout(() => {
                        notification.classList.remove('translate-x-full');
                    }, 100);
                    
                    // Remove after 3 seconds
                    setTimeout(() => {
                        notification.classList.add('translate-x-full');
                        setTimeout(() => {
                            document.body.removeChild(notification);
                        }, 300);
                    }, 3000);
                }
            }
        }
    </script>
</body>
</html>